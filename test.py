# -*- coding: utf-8 -*-
import os
import time
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch
from tqdm import tqdm
import json
from search_docs import search
from use_API import QwenClient

os.environ["CUDA_VISIBLE_DEVICES"] = "0,1,2,3"
SYSTEM_PROMPT = """
你是一个精通阅读理解任务与政策答复任务的人工智能助手。你的任务是根据提供的文件内容，对群众的问题进行专业、具体、合规的解答

【任务要求】：
1. 回答内容应严格基于提供的政策文件内容，尽量详细；同时不要完全照搬给出的文件内容，灵活地根据所问问题，从给出文件中找出依据回答问题。
2. 回答应引用具体文件名称和条款（例如“根据《养老机构管理方法》第三条……”）；你需要找出最恰当的引用文件；
3. 最终只输出【回答】部分，回答完毕后不要继续输出任何内容，不得输出任务额外说明

下面是两个例子，请仿照它们给出高质量的答复：
例子 1：
【留言】我市有一旅居康养养老机构，市场局登记注册，名字为：益年养老服务有限公司。内设两个楼，一个叫旅居康养楼（专门为外地旅居人员提供住宿），一个叫养老护理楼（专门承接当地入住需求老人），总床位177张。如果以“益年养老服务有限公司”名称备案，入住率达不到等级评定要求。请问：两个楼可以分开备案吗？具体如何操作？
【回答】根据《养老机构管理办法》第二条，养老机构是指依法办理登记，为老年人提供全日集中住宿和照料护理服务，床位数在10张以上的机构。符合养老机构条件的，依法办理登记后，按照《养老机构管理办法》第十条、第十一条有关规定办理备案。在养老机构备案的床位应是实际用于提供养老服务的床位。备案为养老机构的场所，应该考虑床位的实际用途，办理备案的具体要求可咨询当地民政部门。

例子二：
【留言】:"现有一人及其年迈母亲想申请低保，其父亲已去世，父亲名下有三套房，父亲去世后未过户，房子仍在其父亲名下，但现在这个人及其母亲住在房子里，这个人还有个姐姐，已成家。这样的话，核查他们名下是没有房子的，但是实际上他们有房住，是否需要其他关于房产的证明？经济适用房购买时有如下规定：“如果双方父母有去世的，名下有未继承的房产，必须做公证由谁来继承，并提交继承后新的产权证。”申请低保时是否有相关规定？"
【回答】:您好，根据《最低生活保障审核确认办法》（民发〔2021〕57号）第十四条规定，家庭财产指共同生活的家庭成员拥有的全部动产和不动产。低保家庭财产核查工作由当地县级民政部门和乡镇人民政府（街道办事处）负责，详细规定请咨询当地县级民政部门或乡镇人民政府（街道办事处），咨询电话可从全国社会救助服务热线（hotline.treeyee.com）查询。

请完成以下任务：
"""

model_path = '/home/pkuiti26/xiaobei/llmbase/qwen/Qwen2___5-32B-Instruct'
tokenizer = AutoTokenizer.from_pretrained(model_path)
model = AutoModelForCausalLM.from_pretrained(
    model_path,
    trust_remote_code=True,
    torch_dtype=torch.float16,
    device_map="auto"
)
import time
time.sleep(10000)

# # 使用大模型回答问题
#
# input_file_path = '全部存在且所需文档能被检索.jsonl'
# # output_file_path = '大模型回答.jsonl'
# output_file_path = '大模型回答(top10).jsonl'
#
# # 加载已处理的问题
# processed_questions = set()
# # with open(output_file_path, 'r', encoding='utf8') as out_check:
# #     for line in out_check:
# #         record = json.loads(line.strip())
# #         processed_questions.add(record["问题内容"].strip())
#
# with open(input_file_path, 'r', encoding='utf8') as infile, \
#     open(output_file_path, 'w', encoding='utf8') as outfile:
#
#     n = 1
#     for line in tqdm(infile, desc="Processing questions"):
#         begin_time = time.time()
#         record = json.loads(line.strip())
#         question = record.get("问题内容", "").strip()
#         # if not question or question in processed_questions:
#         #     n = n+1
#         #     continue
#         if not question:
#             n = n+1
#             continue
#
#         # 检索相关文档
#         doc, _ = search(question)
#
#         # 构建 prompt
#         prompt = f"<|im_start|>system\n{SYSTEM_PROMPT}<|im_end|>\n" \
#                  f"<|im_start|>user\n【留言】{question}\n\n【参考文件】{doc}<|im_end|>\n" \
#                  f"<|im_start|>assistant\n【回答】"
#
#         inputs = tokenizer(prompt, return_tensors="pt").to(model.device)
#         with torch.no_grad():
#             outputs = model.generate(
#                 **inputs,
#                 max_new_tokens=512,
#                 pad_token_id=tokenizer.eos_token_id,
#                 eos_token_id=tokenizer.eos_token_id,
#                 do_sample=False
#             )
#
#         full_output = tokenizer.decode(outputs[0], skip_special_tokens=True)
#
#         # 提取回答
#         answer = full_output.split("【回答】")[-1].split("<|im_end|")[0].strip()
#
#         # 写入结果
#         output_record = {
#             "问题内容": question,
#             "所需文档": doc,
#             "模型回复": answer
#         }
#         outfile.write(json.dumps(output_record, ensure_ascii=False) + "\n")
#         outfile.flush()
#         end_time = time.time()
#         torch.cuda.empty_cache()
#         print(f"第{n}个问题耗时{end_time - begin_time}秒")
#         n = n+1
#
# SYSTEM_PROMPT2 = """
# 你是一位专业且严格的政策答复质量评估员，任务是对于【问题】回答的【参考答案】和【模型答案】，对【模型答案】的质量进行评分（0～10分），评分标准如下：
#
# 评分维度】：
# 1. **政策依据引用**（重点维度）：是否正确引用了相关文件？是否有错误引用？
# 2. **信息一致性**：是否涵盖了参考答案中的主要信息点？
# 3. **表达准确性**：用词是否得当？句子是否通顺、清晰？
# 你最关注的应该是政策依据引用这个维度。
#
# 【评分规则】：
# - 10 分：模型回答与参考答案高度一致，准确全面地回答了问题，逻辑清晰、表述自然，引用合理；
# - 8～9 分：模型回答基本准确，内容完整，引用正确，与参考答案略有不同但不影响实际解答；
# - 6～7 分：模型回答部分正确，存在信息缺失或细节不充分的问题；
# - 4～5 分：模型回答基本不符合参考答案，仅有少量相关信息；
# - 1～3 分：模型回答与参考答案严重不符，答非所问；
# - 0 分：模型回答与问题无关或无法理解。
# 请注意：
# - 你的评分标准非常严格，尤其要注意“政策依据引用”的准确性；
# - 如果模型生成的答案中的引用与参考答案中的一致，且表达的意思差不多，便可以打高分；
# - 如果模型答案优于参考答案，也可以大胆打高分；
# - 最终只输出【分数】后的数字，不加其它解释说明
#
# 示例一：
# 【问题】"请问民办非企业单位能够对外投资设立公司或合伙企业，作为公司的股东或合伙企业的合伙人？若能够作为合伙人，能成为有限合伙人还是普通合伙人，是否有不同要求？"
# 【参考答案】"目前，社会组织领域登记管理法规对于民办非企业单位对外投资设立企业没有禁止性规定。民办非企业单位能否对外投资设立企业，应当符合该民办非企业单位章程规定的宗旨和业务范围，并遵守其业务主管单位的管理要求、投资所涉行业领域管理要求、设立公司或合伙企业的注册要求等管理规定。根据《民办非企业单位登记管理暂行条例》第二十一条规定，民办非企业单位开展章程规定的活动，按照国家有关规定取得的合法收入，必须用于章程规定的业务活动。"
# 【模型答案】"根据《民办非企业单位登记管理暂行条例》第四条，民办非企业单位不得从事营利性经营活动。因此，民办非企业单位不能对外投资设立公司或合伙企业，作为公司的股东或合伙企业的合伙人。这表明民办非企业单位的主要性质是非营利性的，其活动和行为都需遵循这一基本原则。"
#
# 【分数】0
#
# 示例二：
# 【问题】"请问中国汽车流通协会下设了分支机构二手车鉴定评估分会、二手车鉴定评估师分会对外是否需要民政部进行审批？"
# 【示例答案】"您好！按照《民政部关于贯彻落实国务院取消全国性社会团体分支机构、代表机构登记行政审批项目的决定的有关问题的通知》相关要求，全国性社会团体根据本团体章程规定的宗旨和业务范围，可以自行决定分支机构、代表机构的设立、变更和终止，并经理事会或常务理事会讨论通过。"
# 【模型答案】"根据《民政部规章》第三条，社会团体设立分支机构、代表机构应当按照章程的规定，履行民主程序，经业务主管单位审查同意后，向负责该社会团体登记的登记管理机关提出申请。经登记管理机关登记后，方可开展活动。因此，中国汽车流通协会下设分支机构二手车鉴定评估分会、二手车鉴定评估师分会需要经过业务主管单位审查同意后，向登记管理机关提出申请，并获得批准后才能开展活动。这表明，这些分支机构的设立确实需要得到民政部的审批。"
#
# 【分数】3
#
# 示例三：
# 【问题】"他人冒充本人信息进行婚姻登记，当地民政部门已按相关规定对婚姻登记给予撤销，但在支付宝—卡包—证件仍能关联到婚姻信息。请问，怎么能删除？"
# 【示例答案】"您好！根据《关于印发  关于妥善处理以冒名顶替或者弄虚作假的方式办理婚姻登记问题的指导意见  的通知》第四条有关规定：“民政部门决定撤销或者更正婚姻登记的，应当将撤销或者更正婚姻登记决定书于作出之日起15个工作日内送达当事人及利害关系人，同时抄送人民法院、人民检察院或者公安机关。当事人可以持撤销或者更正婚姻登记决定书办理相关业务，支付宝中的婚姻信息更新建议具体咨询相关部门。"
# 【模型答案】"根据《关于妥善处理以冒名顶替或者弄虚作假的方式办理婚姻登记问题的指导意见》的相关规定，民政部门已经对您反映的身份信息被他人冒用办理婚姻登记的情况进行了核实，并依法撤销了相关婚姻登记。然而，由于系统更新可能存在延迟，导致您的支付宝—卡包—证件中仍然显示有婚姻信息。针对这种情况，建议您携带有效的身份证明以及民政部门出具的婚姻登记撤销证明，前往支付宝客服中心或通过支付宝官方渠道反馈此问题，以便尽快更新您的个人信息，删除错误的婚姻记录。同时，民政部门也会配合做好相关信息的更新工作。"
#
# 【分数】8
#
# 示例四:
# 【问题】"《民办非企业单位名称管理暂行规定》第五条民办非企业单位的字号应当由两个以上的汉字组成。……这里的字号应当两个以上的汉字组成，是否包含两个汉字？"
# 【示例答案】"民办非企业单位名称管理暂行规定》第五条规定，民办非企业单位的字号应当由两个以上的汉字组成。此处包含两个汉字。"
# 【模型答案】"根据《民办非企业单位名称管理暂行规定》第五条，民办非企业单位的字号应当由两个以上的汉字组成。这里提到的“两个以上的汉字”包括两个汉字的情况，即民办非企业单位的字号至少需要由两个汉字构成。"
#
# 【分数】10
#
# 请完成下列任务：
# """
#
# input_file_path1 = '全部存在且所需文档能被检索.jsonl'
# input_file_path2 = '大模型回答(top10).jsonl'
# output_file_path = '回答分数(top10).jsonl'
# n = 1
# with open(input_file_path1, 'r', encoding='utf8') as f1, open(input_file_path2, 'r', encoding='utf8') as f2, open(output_file_path, 'w',encoding='utf-8') as out:
#     for line1, line2 in tqdm(zip(f1, f2), desc="Scoring"):
#         record1 = json.loads(line1.strip())
#         record2  =json.loads(line2.strip())
#
#         question = record1.get('问题内容').strip()
#         answer1 = record1.get('回复内容').strip()
#         answer2 = record2.get('模型回复').strip()
#
#         prompt = f"<|im_start|>system\n{SYSTEM_PROMPT2}<|im_end|>\n" \
#                  f"<|im_start|>user\n【问题】{question}\n【参考答案】{answer1}\n【模型答案】{answer2}\n" \
#                  f"<|im_start|>assistant\n【分数】"
#
#         inputs = tokenizer(prompt, return_tensors="pt").to(model.device)
#         with torch.no_grad():
#             outputs = model.generate(
#                 **inputs,
#                 max_new_tokens=4,
#                 pad_token_id=tokenizer.eos_token_id,
#                 eos_token_id=tokenizer.eos_token_id,
#                 do_sample=False
#             )
#         output = tokenizer.decode(outputs[0], skip_special_tokens=True)
#         score_str = output.split("【分数】")[-1].strip().split()[0]
#         score = int(score_str)
#         # tqdm.write(f"第{n}题：分数={score}")
#         output_record = {
#             "问题内容": question,
#             "分数": score
#         }
#         out.write(json.dumps(output_record, ensure_ascii=False) + "\n")
#         n += 1

# SYSTEM_PROMPT3 = """
# 你是一个精通政策引用标注的人工智能助手。请你根据【问题内容】以及提供的多个政策文档切片，对给定的回答内容加上引用标注。
#
# 【任务目标】：
# 1. 请保持原回答的表达内容**完全不变**。
# 2. 你只需要在其中合适的地方加上引用编号，如[1],[2],这些编号对应下方给出的文档切片；
# 3. 若某句或某段话的内容表达的意思与某个切片的内容高度相符，请在该句末尾处加上对应编号；注意：需要是高度相符！
# 4. 每次引用**只使用一个编号**，**不重复标注**；
# 5. 请输出完整的加标注后的【回答】，不需要其他解释说明。
#
# 示例一：
# 【问题内容】"民政部新出台的《刚性支出困难家庭认定办法》（民发〔2024〕57号）中，第四条第二款：“共同生活家庭成员人均收入低于上年度当地居民人均可支配收入；”请问：这里的家庭成员人均收入是指没有扣减支出（含刚性支出）前的全部收入、还是指扣减支出（刚性支出）后的收入，请给予明确谢谢。"
# 【所需文档】"[1]文档来源:民政部办公厅关于加强低收入人口认定和动态监测工作的通知_其他文件_20240430150739_社会救助司.pdf\n切片内容:对家庭人均收入低于上年度当地居民人均可支配收入，家庭财产状况符合当地相关规定，且医疗、教育等必需支出占家庭总收入比例超过当地规定比例的家庭，认定为刚性支出困难家庭。认定对象信息要及时上传低收入人口数据库。\n\n[2]文档来源:民政部关于印发刚性支出困难家庭认定办法的通知_规范性文件_20241031191405_社会救助司.pdf\n切片内容:民政部关于印发《刚性支出困难家庭认定办法》的通知 各省、自治区、直辖市民政厅（局），各计划单列市民政局，新疆生产建设兵团民政局： 《刚性支出困难家庭认定办法》已经 2024 年 10 月 12 日民政部第 21 次部长办公会审议通过，现印发给你们，请结合实际，认真贯彻执行。 民政部   2024 年 10 月 24 日 刚性支出困难家庭认定办法 第一条 为规范刚性支出困难家庭认定工作，根据《社会救助暂行办法》、《中共中央办公厅 国务院办公厅印发〈关于改革完善社会救助制度的意见〉的通知》、《国务院办公厅转发民政部等单位〈关于加强低收入人口动态监测做好分层分类社会救助工作的意见〉的通知》等法规和政策的有关规定，制定本办法。\n 第二条 刚性支出困难家庭认定工作应当遵循属地负责、因地制宜、公平公正、便民利民的原则。 第三条 县级人民政府民政部门负责刚性支出困难家庭认定工作，并接受上级人民政府民政部门的指导、监督。 认定权限按规定下放至乡镇人民政府（街道办事处）的，县级人民政府民政部门要加强指导、监督。\n 第四条 刚性支出困难家庭应当同时具备下列条件： （一）未纳入最低生活保障、特困人员救助供养范围且未被认定为最低生活保障边缘家庭； （二）共同生活家庭成员人均收入低于上年度当地居民人均可支配收入； （三）家庭财产状况符合当地相关规定； （四）提出申请前十二个月家庭刚性支出总额占家庭总收入比例超出当地规定； （五）县级以上地方人民政府规定的其他条件。\n 各地应当根据实际，科学合理设定家庭财产状况和刚性支出总额占比条件。家庭财产状况条件可以参照最低生活保障边缘家庭的认定条件或者适当放宽。 第五条 刚性支出包括以下必需支出： （一）生活支出。指共同生活家庭成员为维持基本生活而发生的支出，包括必要的衣、食、住、行、用等费用支出。 （二）医疗支出。指共同生活家庭成员在定点医药机构就医就诊发生的，经基本医疗保险、大病保险、医疗救助、补充医疗保险、商业健康保险等支付后，由个人负担的符合规定的门诊和住院费用，原则上依据有效票据认定。\n 科高等学校、高等职业学校、高等专科学校、中等职业学校、普通高中、初中和小学阶段，由个人负担的保教费或者学费、住宿费，原则上按照就读幼儿园、学校所在地的教育主管部门提供的同类公办幼儿园、学校收费标准认定。 （四）残疾康复支出。指共同生活家庭成员中的残疾人接受基本康复训练、辅助器具适配等残疾人基本康复服务，扣除政府补助、商业保险赔付费用等部分后，由个人负担的费用，原则上依据有效票据认定。 （五）其他支出。由县级人民政府民政部门根据实际情况另外认定的支出。 前款规定的残疾人基本康复服务及辅助器具范围，按照当地有关目录执行。\n 第六条 申请认定刚性支出困难家庭，应当以家庭为单位由一名共同生活家庭成员提出。 申请人应当如实提交有关材料和反映真实情况，配合开展家庭经济状况调查。 第七条 经审核符合条件的，县级人民政府民政部门应当作出认定为刚性支出困难家庭的书面决定；不符合条件的，不予认定，县级人民政府民政部门应当书面告知结果并说明理由。 第八条 县级人民政府民政部门应当自申请受理之日起三十个工作日之内完成认定工作。存在人户分离或者家庭经济状况调查难度较大等特殊情况的，认定期限可以延长至四十五个工作日。\n 第九条 对于情形复杂的，县级人民政府民政部门可以启动县级困难群众基本生活保障工作协调机制，通过“一事一议”方式集体研究决定。 第十条 经审核认定为刚性支出困难家庭的，有效期一般不超过十二个月。在有效期内，刚性支出困难家庭按照规定获得相应社会救助或者帮扶。 提交且无变化的申请材料，不要求重复提交。\n 第十一条 县级以上地方人民政府民政部门应当在低收入人口动态监测信息平台中将刚性支出困难家庭单独标示，并纳入常态化监测预警范围，为相关部门和单位开展刚性支出困难家庭救助帮扶提供信息查询、需求推送等服务支持。 第十二条 县级以上地方人民政府民政部门应当畅通社会救助服务热线，受理对刚性支出困难家庭认定工作的咨询、投诉、举报，接受社会监督。 第十三条 本办法由民政部负责解释。各地应当结合实际情况，制定刚性支出困难家庭具体认定办法和程序。 第十四条 本办法自 2025 年 1 月 1 日起施行。 \n\n[3]文档来源:民政部关于印发刚性支出困难家庭认定办法的通知_规范性文件_20241031191405_社会救助司.pdf\n切片内容: 第四条 刚性支出困难家庭应当同时具备下列条件： （一）未纳入最低生活保障、特困人员救助供养范围且未被认定为最低生活保障边缘家庭； （二）共同生活家庭成员人均收入低于上年度当地居民人均可支配收入； （三）家庭财产状况符合当地相关规定； （四）提出申请前十二个月家庭刚性支出总额占家庭总收入比例超出当地规定； （五）县级以上地方人民政府规定的其他条件。\n\n[4]文档来源:刚性支出困难家庭认定办法解读_权威解读_20241031154925_社会救助司.pdf\n切片内容:《刚性支出困难家庭认定办法》解读近日，民政部公布《刚性支出困难家庭认定办法》（下称《办法》），现解读如下：一、制定背景刚性支出困难家庭有别于低保家庭、特困人员等传统的社会救助对象，其家庭成员一般拥有一定收入，但因在医疗、教育、残疾康复等方面的刚性支出较大，导致其家庭基本生活存在实际困难。做好刚性支出困难家庭的认定工作，是健全完善分层分类社会救助体系，减缓“悬崖效应”，形成梯度救助格局的重要举措和必然要求。2020 年中共中央办公厅、国务院办公厅印发《关于改革完善社会救助制度的意见》，对刚性支出困难家庭救助工作提出原则性要求。2023 年国务院办公厅转发民政部等单位《关于加强低收入人口动态监测做好分层分类社会救助工作的意见》（国办发〔2023〕39 号），将刚性支出困难家庭成员作为六类“低收入人口”中的一类，明确将其纳入救助帮扶范围。\n\n[5]文档来源:民政部关于印发刚性支出困难家庭认定办法的通知_规范性文件_20241031191405_社会救助司.pdf\n切片内容:民政部关于印发《刚性支出困难家庭认定办法》的通知 各省、自治区、直辖市民政厅（局），各计划单列市民政局，新疆生产建设兵团民政局： 《刚性支出困难家庭认定办法》已经 2024 年 10 月 12 日民政部第 21 次部长办公会审议通过，现印发给你们，请结合实际，认真贯彻执行。 民政部   2024 年 10 月 24 日 刚性支出困难家庭认定办法 第一条 为规范刚性支出困难家庭认定工作，根据《社会救助暂行办法》、《中共中央办公厅 国务院办公厅印发〈关于改革完善社会救助制度的意见〉的通知》、《国务院办公厅转发民政部等单位〈关于加强低收入人口动态监测做好分层分类社会救助工作的意见〉的通知》等法规和政策的有关规定，制定本办法。\n\n[6]文档来源:民政部关于印发刚性支出困难家庭认定办法的通知_规范性文件_20241031191405_社会救助司.pdf\n切片内容: 各地应当根据实际，科学合理设定家庭财产状况和刚性支出总额占比条件。家庭财产状况条件可以参照最低生活保障边缘家庭的认定条件或者适当放宽。 第五条 刚性支出包括以下必需支出： （一）生活支出。指共同生活家庭成员为维持基本生活而发生的支出，包括必要的衣、食、住、行、用等费用支出。 （二）医疗支出。指共同生活家庭成员在定点医药机构就医就诊发生的，经基本医疗保险、大病保险、医疗救助、补充医疗保险、商业健康保险等支付后，由个人负担的符合规定的门诊和住院费用，原则上依据有效票据认定。\n\n[7]文档来源:民政部关于印发刚性支出困难家庭认定办法的通知_规范性文件_20241031191405_社会救助司.pdf\n切片内容: 第十一条 县级以上地方人民政府民政部门应当在低收入人口动态监测信息平台中将刚性支出困难家庭单独标示，并纳入常态化监测预警范围，为相关部门和单位开展刚性支出困难家庭救助帮扶提供信息查询、需求推送等服务支持。 第十二条 县级以上地方人民政府民政部门应当畅通社会救助服务热线，受理对刚性支出困难家庭认定工作的咨询、投诉、举报，接受社会监督。 第十三条 本办法由民政部负责解释。各地应当结合实际情况，制定刚性支出困难家庭具体认定办法和程序。 第十四条 本办法自 2025 年 1 月 1 日起施行。 \n\n[8]文档来源:国务院办公厅转发民政部等单位关于加强低收入人口动态监测做好分层分类社会救助工作的意见的通知_其他文件_20231023085336_其它.pdf\n切片内容:对不符合最低生活保障条件，但家庭人均收入低于当地最低生活保障标准 1.5 倍，且家庭财产状况符合当地相关规定的家庭，认定为最低生活保障边缘家庭；最低生活保障边缘家庭收入、财产的具体界定、核查范围和核算方法以及认定程序等，可参照当地最低生活保障相关规定执行，对家庭中已实现就业的人员，在核算收入时可按规定适当扣减必要的就业成本。对家庭人均收入低于上年度当地居民人均可支配收入，家庭财产状况符合当地相关规定，且医疗、教育等必需支出占家庭总收入比例超过当地规定比例的家庭，认定为刚性支出困难家庭，具体认定办法和程序由各地根据实际情况制定。\n\n[9]文档来源:刚性支出困难家庭认定办法解读_权威解读_20241031154925_社会救助司.pdf\n切片内容:《刚性支出困难家庭认定办法》解读近日，民政部公布《刚性支出困难家庭认定办法》（下称《办法》），现解读如下：一、制定背景刚性支出困难家庭有别于低保家庭、特困人员等传统的社会救助对象，其家庭成员一般拥有一定收入，但因在医疗、教育、残疾康复等方面的刚性支出较大，导致其家庭基本生活存在实际困难。做好刚性支出困难家庭的认定工作，是健全完善分层分类社会救助体系，减缓“悬崖效应”，形成梯度救助格局的重要举措和必然要求。2020 年中共中央办公厅、国务院办公厅印发《关于改革完善社会救助制度的意见》，对刚性支出困难家庭救助工作提出原则性要求。2023 年国务院办公厅转发民政部等单位《关于加强低收入人口动态监测做好分层分类社会救助工作的意见》（国办发〔2023〕39 号），将刚性支出困难家庭成员作为六类“低收入人口”中的一类，明确将其纳入救助帮扶范围。\n近年来，各地探索开展刚性支出困难家庭认定和救助工作，积累了大量实践经验，但在认定条件、刚性支出范围等方面存在较大差异，影响了认定工作均衡发展，迫切需要在国家层面作出统一规范。\n为进一步健全完善分层分类的社会救助体系，做好对象分层和精准认定，近日，民政部印发《刚性支出困难家庭认定办法》，对刚性支出困难家庭认定工作提出明确要求。二、主要内容《办法》共十四条，主要围绕“谁认定、认定谁”等关键问题，从责任主体、资格条件、监督管理等方面作出规定。（一）关于基本原则。《办法》强调，刚性支出困难家庭认定工作应当遵循属地负责、因地制宜、公平公正、便民利民的原则。（二）关于责任主体。《办法》参照低保对象认定相关规定，明确由县级民政部门负责刚性支出困难家庭认定工作，认定权限下放至乡镇（街道）的，县级民政部门加强指导、监督。\n（四）关于刚性支出范围。从地方实践看，因医疗、教育、残疾康复等支出较大造成居民基本生活困难，是当前群众反映较为集中和突出的问题。《办法》立足与经济社会发展和居民生活水平相适应这一根本，以需求为导向，一方面，突破“衣食住燃”等传统“居民基本生活”内容，将关注重点瞄准医疗、教育、残疾康复等群众急难愁盼问题，明确刚性支出包括家庭成员的生活支出、医疗支出、教育支出、残疾康复支出及其他支出等项目，并从提高操作性出发，明确了各项刚性支出的测算方式、认定依据等。\n另一方面，通过明确刚性支出范围，推动医疗、教育、住房等专项救助向刚性支出困难家庭延伸。（五）关于有效期设置。刚性支出困难家庭不同于低保和低保边缘家庭，其自身具有一定的发展能力，面临的大多属于阶段性生活困难。为此，《办法》对刚性支出困难家庭认定规定了有效期，明确有效期一般不超过十二个月。有效期期满后，需要继续认定为刚性支出困难家庭的，应当按照本办法重新申请。对于前期已经提交且无变化的申请材料，不再要求重复提交。\n\n[10]文档来源:民政部对“将有一定收入的刚性支出导致的贫困家庭纳入低保范围的建议”的答复_人大代表建议答复摘要_20200913160512.pdf\n切片内容:现答复如下： “支出型”贫困问题是社会救助工作的难点和热点，近年来，民政部就解决“支出型”贫困问题进行了探索，主要做了以下工作： 一是在低保对象认定中统筹考虑刚性支出因素。2016 年 9 月，民政部等 6 部门报请国务院办公厅转发了《关于做好农村最低生活保障制度与扶贫开发政策有效衔接的指导意见》（国办发〔2016〕70 号），要求各地完善农村低保家庭贫困状况评估指标体系，以家庭收入、财产作为主要指标，根据地方实际情况适当考虑家庭成员因残疾、患重病等增加的刚性支出因素，综合评估家庭贫困程度。\n\n"
# 【模型回复】"根据《刚性支出困难家庭认定办法》第四条第二款的规定，共同生活家庭成员人均收入低于上年度当地居民人均可支配收入。这里的家庭成员人均收入是指没有扣减支出（含刚性支出）前的全部收入。因此，在计算家庭成员人均收入时，不应扣除刚性支出。具体操作细则可进一步咨询当地县级民政部门。"
#
# 【带引用的回复】"根据《刚性支出困难家庭认定办法》第四条第二款的规定，共同生活家庭成员人均收入低于上年度当地居民人均可支配收入[3]。这里的家庭成员人均收入是指没有扣减支出（含刚性支出）前的全部收入。因此，在计算家庭成员人均收入时，不应扣除刚性支出。具体操作细则可进一步咨询当地县级民政部门。"
#
# 示例二：
# 【问题内容】"尊敬的民政部门领导，你们好，有律师持已经完结的法院判决书来婚姻登记还可以查阅婚姻登记档案吗"
# 【所需文档】"[1]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容: 第十五条 婚姻登记档案的利用应当遵守下列规定： （一）婚姻登记档案保管部门应当建立档案利用制度，明确办理程序，维护当事人的合法权益； （二）婚姻登记机关可以利用本机关移交的婚姻登记档案； （三）婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证； （四）人民法院、人民检察院、公安和安全部门为确认当事人的婚姻关系，持单位介绍信可以查阅婚姻登记档案；\n\n[2]文档来源:关于婚姻登记档案管理办法的解读_权威解读_20060123103726_民政部门户网站.pdf\n切片内容:  利用婚姻登记档案，涉及当事人的合法权益保护问题，因此，办法规定婚姻登记档案保管部门应当建立档案利用制度，确定审批程序。婚姻登记档案一般仅供婚姻登记机关和婚姻当事人使用；司法机关、律师及其他诉讼代理人为了确认当事人的婚姻关系，持合法证明可以查阅；其它单位、组织或个人因特殊原因需要查阅婚姻登记档案，须经档案保管部门主管领导批准，并严格履行查阅手续；婚姻登记档案一律不外借；利用者不得损毁婚姻登记档案，不得随意公开婚姻登记档案的内容。\n\n[3]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容:律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案； （五）其他单位、组织和个人要求查阅婚姻登记档案的，婚姻登记档案保管部门在确认其利用目的合理的情况下，经主管领导审核，可以利用； （六）利用婚姻登记档案的单位、组织和个人，不得公开婚姻登记档案的内容，不得损害婚姻登记当事人的合法权益； （七）婚姻登记档案不得外借，仅限于当场查阅；复印的婚姻登记档案需加盖婚姻登记档案保管部门的印章方为有效。\n\n[4]文档来源:263575.pdf\n切片内容:（四）人民法院、人民检察院、公安和安全部门为确认当事人的婚姻关系，持单位介绍信可以查阅婚姻登记档案；律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证7  X民政部规章明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案；（五）其他单位、组织和个人要求查阅婚姻登记档案的，婚姻登记档案保管部门在确认其利用目的合理的情况下，经主管领导审核，可以利用；\n\n[5]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容:婚姻登记档案管理办法第一条 为规范婚姻登记档案管理，维护婚姻当事人的合法权益，根据《中华人民共和国档案法》和《婚姻登记条例》，制定本办法。 第二条婚姻登记档案是婚姻登记机关在办理结婚登记、撤销婚姻、离婚登记、补发婚姻登记证的过程中形成的具有凭证作用的各种记录。 第三条婚姻登记主管部门对婚姻登记档案工作实行统一领导，分级管理，并接受同级地方档案行政管理部门的监督和指导。 第四条婚姻登记机关应当履行下列档案工作职责：（一）及时将办理完毕的婚姻登记材料收集、整理、归档； （二）建立健全各项规章制度，确保婚姻登记档案的齐全完整； （三）采用科学的管理方法，提高婚姻登记档案的保管水平； （四）办理查档服务，出具婚姻登记记录证明，告知婚姻登记档案的存放地； （五）办理婚姻登记档案的移交工作。\n 第五条办理结婚登记（含复婚、补办结婚登记，下同）形成的下列材料应当归档： （一）《结婚登记审查处理表》； （二）《申请结婚登记声明书》或者《申请补办结婚登记声明书》； （三）香港特别行政区居民、澳门特别行政区居民、台湾地区居民、出国人员、华侨以及外国人提交的《婚姻登记条例》第五条规定的各种证明材料（含翻译材料）； （四）当事人身份证件（从《婚姻登记条例》第五条规定，下同）复印件； （五）其他有关材料。 第六条办理撤销婚姻形成的下列材料应当归档： （一）婚姻登记机关关于撤销婚姻的决定； （二）《撤销婚姻申请书》； （三）当事人的结婚证原件； （四）公安机关出具的当事人被拐卖、解救证明，或人民法院作出的能够证明当事人被胁迫结婚的判决书； （五）当事人身份证件复印件； （六）其他有关材料。\n律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案； （五）其他单位、组织和个人要求查阅婚姻登记档案的，婚姻登记档案保管部门在确认其利用目的合理的情况下，经主管领导审核，可以利用； （六）利用婚姻登记档案的单位、组织和个人，不得公开婚姻登记档案的内容，不得损害婚姻登记当事人的合法权益； （七）婚姻登记档案不得外借，仅限于当场查阅；复印的婚姻登记档案需加盖婚姻登记档案保管部门的印章方为有效。\n 第十六条 婚姻登记档案的鉴定销毁应当符合下列要求： （一）婚姻登记档案保管部门对保管期限到期的档案要进行价值鉴定，对无保存价值的予以销毁，但婚姻登记档案目录应当永久保存。 （三）婚姻登记档案保管部门应当派人监督婚姻登记档案的销毁过程，确保销毁档案没有漏销或者流失，并在销毁清册上签字。 第十七条本办法由民政部负责解释。 第十八条 本办法自公布之日起施行。\n 第七条 办理离婚登记形成的下列材料应当归档： （一）《离婚登记审查处理表》； （二）《申请离婚登记声明书》； （三）当事人结婚证复印件； （四）当事人离婚协议书； （五）当事人身份证件复印件； （六）其他有关材料。 第八条 办理补发婚姻登记证形成的下列材料应当归档： （一）《补发婚姻登记证审查处理表》； （二）《申请补领婚姻登记证声明书》； （四）当事人身份证件复印件； （五）当事人委托办理时提交的经公证机关公证的当事人身份证件复印件和委托书，受委托人本人的身份证件复印件； （六）其他有关材料。\n 第九条 婚姻登记档案按照年度—婚姻登记性质分类。婚姻登记性质分为结婚登记类、撤销婚姻类、离婚登记类和补发婚姻登记证类四类。 人民法院宣告婚姻无效或者撤销婚姻的判决书副本归入撤销婚姻类档案。 婚姻无效或者撤销婚姻的，应当在当事人原婚姻登记档案的《结婚登记审查处理表》的“备注”栏中注明有关情况及相应的撤销婚姻类档案的档号。\n 第十条婚姻登记材料的立卷归档应当遵循下列原则与方法： （一）婚姻登记材料按照年度归档。 （二）一对当事人婚姻登记材料组成一卷。 （三）卷内材料分别按照本办法第五、六、七、八条规定的顺序排列。 （四）以有利于档案保管和利用的方法固定案卷。 （五）按本办法第九条的规定对案卷进行分类，并按照办理婚姻登记的时间顺序排列。 （六）在卷内文件首页上端的空白处加盖归档章（见附件1），并填写有关内容。\n归档章设置全宗号、年度、室编卷号、馆编卷号和页数等项目。 全宗号：档案馆给立档单位编制的代号。 年度：案卷的所属年度。 室编卷号：案卷排列的顺序号，每年每个类别分别从“1”开始标注。 馆编卷号：档案移交时按进馆要求编用“—”号连接；盒号即档案盒的排列顺序号，在档案移交时按进馆要求编制。 备考表置于盒内，说明本盒档案的情况，并填写整理人、检查人和日期（见附件 4）。 （八）按类别分别编制婚姻登记档案目录（见附件 5）。 （九）每年的婚姻登记档案目录加封面后装订成册，一式三份，并编制目录号（见附件 6）。\n 第十一条 婚姻登记材料的归档要求： （一）当年的婚姻登记材料应当在次年的 3 月 31 日前完成立卷归档； （二）归档的婚姻登记材料必须齐全完整，案卷规范、整齐，复印件一律使用 A4 规格的复印纸，复印件和照片应当图像清晰； （三）归档章、档案盒封面、盒脊、备考表等项目，使用蓝黑墨水或碳素墨水钢笔填写；婚姻登记档案目录应当打印；备考表和档案目录一律使用 A4 规格纸张。\n 第十二条使用计算机办理婚姻登记所形成的电子文件，应当与纸质文件一并归档，归档要求参照《电子文件归档与管理规范》（GBT18894-2002）。 第十三条 婚姻登记档案的保管期限为 100 年。对有继续保存价值的可以延长保管期限直至永久。\n 第十四条婚姻登记档案应当按照下列规定进行移交： （一）县级（含）以上地方人民政府民政部门形成的婚姻登记档案，应当在本单位档案部门保管一定时期后向同级国家档案馆移交，具体移交时间由双方商定。 乡（镇）人民政府应当将每年的婚姻登记档案目录副本向上一级人民政府民政部门报送。 （三） 被撤销或者合并的婚姻登记机关的婚姻登记档案应当按照前两款的规定及时移交。\n 第十五条 婚姻登记档案的利用应当遵守下列规定： （一）婚姻登记档案保管部门应当建立档案利用制度，明确办理程序，维护当事人的合法权益； （二）婚姻登记机关可以利用本机关移交的婚姻登记档案； （三）婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证； （四）人民法院、人民检察院、公安和安全部门为确认当事人的婚姻关系，持单位介绍信可以查阅婚姻登记档案；\n\n[6]文档来源:关于婚姻登记档案管理办法的解读_权威解读_20060123103726_民政部门户网站.pdf\n切片内容:  2、婚姻登记档案的分类。度、婚姻登记性质两个层次划分。其中按婚姻登记性质分为结婚登记类、离婚登记类、补发婚姻登记证类、撤销婚姻类。  根据《婚姻登记条例》第十六条规定，婚姻登记机关收到人民法院宣告婚姻无效或者撤销婚姻的判决书副本后，应将其归入当事人的婚姻登记档案，从方便档案整理和利用两方面考虑，规定人民法院宣告婚姻无效或者撤销婚姻的判决书副本按年度归入撤销婚姻类。因为宣告婚姻无效或者撤销婚姻是对原结婚事实的否定，所以特别强调要在当事人原结婚登记档案的《结婚登记审查处理表》中备注有关情况。\n\n[7]文档来源:263575.pdf\n切片内容:第十五条  婚姻登记档案的利用应当遵守下列规定：（一）婚姻登记档案保管部门应当建立档案利用制度，明确办理程序，维护当事人的合法权益；（二）婚姻登记机关可以利用本机关移交的婚姻登记档案；（三）婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证；\n\n[8]文档来源:263575.pdf\n切片内容:第九条  婚姻登记档案按照年度—婚姻登记性质分类。婚姻登记性质分为结婚登记类、撤销婚姻类、离婚登记类和补发婚姻登记证类四类。人民法院宣告婚姻无效或者撤销婚姻的判决书副本归入撤销婚姻类档案。婚姻无效或者撤销婚姻的，应当在当事人原婚姻登记档案的《结婚登记审查处理表》的“备注”栏中注明有关情况及相应的撤销婚姻类档案的档号。\n\n[9]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容: 第九条 婚姻登记档案按照年度—婚姻登记性质分类。婚姻登记性质分为结婚登记类、撤销婚姻类、离婚登记类和补发婚姻登记证类四类。 人民法院宣告婚姻无效或者撤销婚姻的判决书副本归入撤销婚姻类档案。 婚姻无效或者撤销婚姻的，应当在当事人原婚姻登记档案的《结婚登记审查处理表》的“备注”栏中注明有关情况及相应的撤销婚姻类档案的档号。\n\n[10]文档来源:关于印发关于妥善处理以冒名顶替或者弄虚作假的方式办理婚姻登记问题的指导意见的通知_其他文件_20211231111448_其它.pdf\n切片内容:民政部门决定撤销或者更正婚姻登记的，应当将撤销或者更正婚姻登记决定书于作出之日起 15 个工作日内送达当事人及利害关系人，同时抄送人民法院、人民检察院或者公安机关。民政部门作出撤销或者更正婚姻登记决定后，应当及时在婚姻登记管理信息系统中备注说明情况并在附件中上传决定书。同时参照婚姻登记档案管理相关规定存档保管相关文书和证据材料。\n\n"
# 【模型回复】"根据《婚姻登记档案管理办法》第十五条的规定，律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案。因此，如果律师持有已经完结的法院判决书，并且该判决书与婚姻登记档案有关联，同时携带了律师的有效证件，那么是可以查阅相关的婚姻登记档案的。不过，查阅行为应当遵守档案利用的相关规定，不得公开档案内容，也不得损害婚姻登记当事人的合法权益。"
#
# 【带引用的回复】根据《婚姻登记档案管理办法》第十五条的规定，律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案[3]。因此，如果律师持有已经完结的法院判决书，并且该判决书与婚姻登记档案有关联，同时携带了律师的有效证件，那么是可以查阅相关的婚姻登记档案的。不过，查阅行为应当遵守档案利用的相关规定，不得公开档案内容，也不得损害婚姻登记当事人的合法权益[3]。
#
# 示例三：
# [问题内容】"你好领导，我是山东的一名律师。现因办案过程中遇到的档案查询问题寻求帮助。当事人想提起离婚诉讼，但因结婚证件在女方手中，而法院立案又要求婚姻关系证明，于是当事人委托律师查询婚姻关系。婚姻登记机关却告知按照《婚姻登记档案管理办法》（民政部、国家档案局令第32号）第十五条第三项的规定，需办理公证委托手续。本人认为该规定不适用于律师调取本人婚姻登记的情形；如适用，不仅违反法律规定，同时又增加了当事人的诉累，属不合法及不合理的规定。但因规定不明确，导致办理人员在适用上存在机械套用的情况。在此希望明确律师调取本人婚姻登记情况只需出具委托书及律师有效证件、律所介绍信。望处理为盼。"
# 【所需文档】"[1]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容:律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案； （五）其他单位、组织和个人要求查阅婚姻登记档案的，婚姻登记档案保管部门在确认其利用目的合理的情况下，经主管领导审核，可以利用； （六）利用婚姻登记档案的单位、组织和个人，不得公开婚姻登记档案的内容，不得损害婚姻登记当事人的合法权益； （七）婚姻登记档案不得外借，仅限于当场查阅；复印的婚姻登记档案需加盖婚姻登记档案保管部门的印章方为有效。\n\n[2]文档来源:263575.pdf\n切片内容:（四）人民法院、人民检察院、公安和安全部门为确认当事人的婚姻关系，持单位介绍信可以查阅婚姻登记档案；律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证7  X民政部规章明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案；（五）其他单位、组织和个人要求查阅婚姻登记档案的，婚姻登记档案保管部门在确认其利用目的合理的情况下，经主管领导审核，可以利用；\n\n[3]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容: 第十五条 婚姻登记档案的利用应当遵守下列规定： （一）婚姻登记档案保管部门应当建立档案利用制度，明确办理程序，维护当事人的合法权益； （二）婚姻登记机关可以利用本机关移交的婚姻登记档案； （三）婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证； （四）人民法院、人民检察院、公安和安全部门为确认当事人的婚姻关系，持单位介绍信可以查阅婚姻登记档案；\n\n[4]文档来源:263575.pdf\n切片内容:第十五条  婚姻登记档案的利用应当遵守下列规定：（一）婚姻登记档案保管部门应当建立档案利用制度，明确办理程序，维护当事人的合法权益；（二）婚姻登记机关可以利用本机关移交的婚姻登记档案；（三）婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证；\n\n[5]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容:婚姻登记档案管理办法第一条 为规范婚姻登记档案管理，维护婚姻当事人的合法权益，根据《中华人民共和国档案法》和《婚姻登记条例》，制定本办法。 第二条婚姻登记档案是婚姻登记机关在办理结婚登记、撤销婚姻、离婚登记、补发婚姻登记证的过程中形成的具有凭证作用的各种记录。 第三条婚姻登记主管部门对婚姻登记档案工作实行统一领导，分级管理，并接受同级地方档案行政管理部门的监督和指导。 第四条婚姻登记机关应当履行下列档案工作职责：（一）及时将办理完毕的婚姻登记材料收集、整理、归档； （二）建立健全各项规章制度，确保婚姻登记档案的齐全完整； （三）采用科学的管理方法，提高婚姻登记档案的保管水平； （四）办理查档服务，出具婚姻登记记录证明，告知婚姻登记档案的存放地； （五）办理婚姻登记档案的移交工作。\n 第五条办理结婚登记（含复婚、补办结婚登记，下同）形成的下列材料应当归档： （一）《结婚登记审查处理表》； （二）《申请结婚登记声明书》或者《申请补办结婚登记声明书》； （三）香港特别行政区居民、澳门特别行政区居民、台湾地区居民、出国人员、华侨以及外国人提交的《婚姻登记条例》第五条规定的各种证明材料（含翻译材料）； （四）当事人身份证件（从《婚姻登记条例》第五条规定，下同）复印件； （五）其他有关材料。 第六条办理撤销婚姻形成的下列材料应当归档： （一）婚姻登记机关关于撤销婚姻的决定； （二）《撤销婚姻申请书》； （三）当事人的结婚证原件； （四）公安机关出具的当事人被拐卖、解救证明，或人民法院作出的能够证明当事人被胁迫结婚的判决书； （五）当事人身份证件复印件； （六）其他有关材料。\n律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案； （五）其他单位、组织和个人要求查阅婚姻登记档案的，婚姻登记档案保管部门在确认其利用目的合理的情况下，经主管领导审核，可以利用； （六）利用婚姻登记档案的单位、组织和个人，不得公开婚姻登记档案的内容，不得损害婚姻登记当事人的合法权益； （七）婚姻登记档案不得外借，仅限于当场查阅；复印的婚姻登记档案需加盖婚姻登记档案保管部门的印章方为有效。\n 第十六条 婚姻登记档案的鉴定销毁应当符合下列要求： （一）婚姻登记档案保管部门对保管期限到期的档案要进行价值鉴定，对无保存价值的予以销毁，但婚姻登记档案目录应当永久保存。 （三）婚姻登记档案保管部门应当派人监督婚姻登记档案的销毁过程，确保销毁档案没有漏销或者流失，并在销毁清册上签字。 第十七条本办法由民政部负责解释。 第十八条 本办法自公布之日起施行。\n 第七条 办理离婚登记形成的下列材料应当归档： （一）《离婚登记审查处理表》； （二）《申请离婚登记声明书》； （三）当事人结婚证复印件； （四）当事人离婚协议书； （五）当事人身份证件复印件； （六）其他有关材料。 第八条 办理补发婚姻登记证形成的下列材料应当归档： （一）《补发婚姻登记证审查处理表》； （二）《申请补领婚姻登记证声明书》； （四）当事人身份证件复印件； （五）当事人委托办理时提交的经公证机关公证的当事人身份证件复印件和委托书，受委托人本人的身份证件复印件； （六）其他有关材料。\n 第九条 婚姻登记档案按照年度—婚姻登记性质分类。婚姻登记性质分为结婚登记类、撤销婚姻类、离婚登记类和补发婚姻登记证类四类。 人民法院宣告婚姻无效或者撤销婚姻的判决书副本归入撤销婚姻类档案。 婚姻无效或者撤销婚姻的，应当在当事人原婚姻登记档案的《结婚登记审查处理表》的“备注”栏中注明有关情况及相应的撤销婚姻类档案的档号。\n 第十条婚姻登记材料的立卷归档应当遵循下列原则与方法： （一）婚姻登记材料按照年度归档。 （二）一对当事人婚姻登记材料组成一卷。 （三）卷内材料分别按照本办法第五、六、七、八条规定的顺序排列。 （四）以有利于档案保管和利用的方法固定案卷。 （五）按本办法第九条的规定对案卷进行分类，并按照办理婚姻登记的时间顺序排列。 （六）在卷内文件首页上端的空白处加盖归档章（见附件1），并填写有关内容。\n归档章设置全宗号、年度、室编卷号、馆编卷号和页数等项目。 全宗号：档案馆给立档单位编制的代号。 年度：案卷的所属年度。 室编卷号：案卷排列的顺序号，每年每个类别分别从“1”开始标注。 馆编卷号：档案移交时按进馆要求编用“—”号连接；盒号即档案盒的排列顺序号，在档案移交时按进馆要求编制。 备考表置于盒内，说明本盒档案的情况，并填写整理人、检查人和日期（见附件 4）。 （八）按类别分别编制婚姻登记档案目录（见附件 5）。 （九）每年的婚姻登记档案目录加封面后装订成册，一式三份，并编制目录号（见附件 6）。\n 第十一条 婚姻登记材料的归档要求： （一）当年的婚姻登记材料应当在次年的 3 月 31 日前完成立卷归档； （二）归档的婚姻登记材料必须齐全完整，案卷规范、整齐，复印件一律使用 A4 规格的复印纸，复印件和照片应当图像清晰； （三）归档章、档案盒封面、盒脊、备考表等项目，使用蓝黑墨水或碳素墨水钢笔填写；婚姻登记档案目录应当打印；备考表和档案目录一律使用 A4 规格纸张。\n 第十二条使用计算机办理婚姻登记所形成的电子文件，应当与纸质文件一并归档，归档要求参照《电子文件归档与管理规范》（GBT18894-2002）。 第十三条 婚姻登记档案的保管期限为 100 年。对有继续保存价值的可以延长保管期限直至永久。\n 第十四条婚姻登记档案应当按照下列规定进行移交： （一）县级（含）以上地方人民政府民政部门形成的婚姻登记档案，应当在本单位档案部门保管一定时期后向同级国家档案馆移交，具体移交时间由双方商定。 乡（镇）人民政府应当将每年的婚姻登记档案目录副本向上一级人民政府民政部门报送。 （三） 被撤销或者合并的婚姻登记机关的婚姻登记档案应当按照前两款的规定及时移交。\n 第十五条 婚姻登记档案的利用应当遵守下列规定： （一）婚姻登记档案保管部门应当建立档案利用制度，明确办理程序，维护当事人的合法权益； （二）婚姻登记机关可以利用本机关移交的婚姻登记档案； （三）婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证； （四）人民法院、人民检察院、公安和安全部门为确认当事人的婚姻关系，持单位介绍信可以查阅婚姻登记档案；\n\n[6]文档来源:关于婚姻登记档案管理办法的解读_权威解读_20060123103726_民政部门户网站.pdf\n切片内容:  利用婚姻登记档案，涉及当事人的合法权益保护问题，因此，办法规定婚姻登记档案保管部门应当建立档案利用制度，确定审批程序。婚姻登记档案一般仅供婚姻登记机关和婚姻当事人使用；司法机关、律师及其他诉讼代理人为了确认当事人的婚姻关系，持合法证明可以查阅；其它单位、组织或个人因特殊原因需要查阅婚姻登记档案，须经档案保管部门主管领导批准，并严格履行查阅手续；婚姻登记档案一律不外借；利用者不得损毁婚姻登记档案，不得随意公开婚姻登记档案的内容。\n\n[7]文档来源:婚姻登记档案管理办法_部门规章_20060123184535_社会事务司.pdf\n切片内容:婚姻登记档案管理办法第一条 为规范婚姻登记档案管理，维护婚姻当事人的合法权益，根据《中华人民共和国档案法》和《婚姻登记条例》，制定本办法。 第二条婚姻登记档案是婚姻登记机关在办理结婚登记、撤销婚姻、离婚登记、补发婚姻登记证的过程中形成的具有凭证作用的各种记录。 第三条婚姻登记主管部门对婚姻登记档案工作实行统一领导，分级管理，并接受同级地方档案行政管理部门的监督和指导。 第四条婚姻登记机关应当履行下列档案工作职责：（一）及时将办理完毕的婚姻登记材料收集、整理、归档； （二）建立健全各项规章制度，确保婚姻登记档案的齐全完整； （三）采用科学的管理方法，提高婚姻登记档案的保管水平； （四）办理查档服务，出具婚姻登记记录证明，告知婚姻登记档案的存放地； （五）办理婚姻登记档案的移交工作。\n\n[8]文档来源:263575.pdf\n切片内容:民政部规章婚姻登记档案管理办法(2006 年 1 月 23 日民政部、国家档案局令第 32 号公布  自公布之日起施行)第一条  为规范婚姻登记档案管理，维护婚姻当事人的合法权益，根据《中华人民共和国档案法》和《婚姻登记条例》，制定本办法。第二条  婚姻登记档案是婚姻登记机关在办理结婚登记、撤销婚姻、离婚登记、补发婚姻登记证的过程中形成的具有凭证作用的各种记录。\n第三条  婚姻登记主管部门对婚姻登记档案工作实行统一领导，分级管理，并接受同级地方档案行政管理部门的监督和指导。第四条  婚姻登记机关应当履行下列档案工作职责：（一）及时将办理完毕的婚姻登记材料收集、整理、归档；（二）建立健全各项规章制度，确保婚姻登记档案的齐全1  X民政部发布     民政部规章完整；（三）采用科学的管理方法，提高婚姻登记档案的保管水平；（四）办理查档服务，出具婚姻登记记录证明，告知婚姻登记档案的存放地；（五）办理婚姻登记档案的移交工作。\n备考表和档案目录一律使用 A4 规格纸张。第十二条  使用计算机办理婚姻登记所形成的电子文件，应当与纸质文件一并归档，归档要求参照《电子文件归档与管理规范》（GB/T18894-2002）。存价值的可以延长保管期限直至永久。\n第十四条  婚姻登记档案应当按照下列规定进行移交：（一）县级（含）以上地方人民政府民政部门形成的婚姻6  X民政部发布     民政部规章登记档案，应当在本单位档案部门保管一定时期后向同级国家档案馆移交，具体移交时间由双方商定。（二）具有办理婚姻登记职能的乡（镇）人民政府形成的婚姻登记档案应当向乡（镇）档案部门移交，具体移交时间从乡（镇）的规定。乡（镇）人民政府应当将每年的婚姻登记档案目录副本向上一级人民政府民政部门报送。（三） 被撤销或者合并的婚姻登记机关的婚姻登记档案应当按照前两款的规定及时移交。\n第十五条  婚姻登记档案的利用应当遵守下列规定：（一）婚姻登记档案保管部门应当建立档案利用制度，明确办理程序，维护当事人的合法权益；（二）婚姻登记机关可以利用本机关移交的婚姻登记档案；（三）婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证；\n（四）人民法院、人民检察院、公安和安全部门为确认当事人的婚姻关系，持单位介绍信可以查阅婚姻登记档案；律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证7  X民政部规章明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案；（五）其他单位、组织和个人要求查阅婚姻登记档案的，婚姻登记档案保管部门在确认其利用目的合理的情况下，经主管领导审核，可以利用；\n（六）利用婚姻登记档案的单位、组织和个人，不得公开婚姻登记档案的内容，不得损害婚姻登记当事人的合法权益；（七）婚姻登记档案不得外借，仅限于当场查阅；复印的婚姻登记档案需加盖婚姻登记档案保管部门的印章方为有效。\n第十六条  婚姻登记档案的鉴定销毁应当符合下列要求：（一）婚姻登记档案保管部门对保管期限到期的档案要进行价值鉴定，对无保存价值的予以销毁，但婚姻登记档案目录应当永久保存。（二）对销毁的婚姻登记档案应当建立销毁清册，载明销毁档案的时间、种类和数量，并永久保存。（三）婚姻登记档案保管部门应当派人监督婚姻登记档案的销毁过程，确保销毁档案没有漏销或者流失，并在销毁清册上签字。第十七条  本办法由民政部负责解释。第十八条  本办法自公布之日起施行。8  X民政部发布     \n第五条  办理结婚登记（含复婚、补办结婚登记，下同）形成的下列材料应当归档：（一）《结婚登记审查处理表》；（二）《申请结婚登记声明书》或者《申请补办结婚登记声明书》；（三）香港特别行政区居民、澳门特别行政区居民、台湾地区居民、出国人员、华侨以及外国人提交的《婚姻登记条例》第五条规定的各种证明材料（含翻译材料）；（四）当事人身份证件（从《婚姻登记条例》第五条规定下同）复印件；（五）其他有关材料。\n第六条  办理撤销婚姻形成的下列材料应当归档：（一）婚姻登记机关关于撤销婚姻的决定；2  X民政部发布     民政部规章（二）《撤销婚姻申请书》；（三）当事人的结婚证原件；（四）公安机关出具的当事人被拐卖、解救证明，或人民法院作出的能够证明当事人被胁迫结婚的判决书；（五）当事人身份证件复印件；（六）其他有关材料。第七条  办理离婚登记形成的下列材料应当归档：（一）《离婚登记审查处理表》；（二）《申请离婚登记声明书》；（三）当事人结婚证复印件；（四）当事人离婚协议书；（五）当事人身份证件复印件；（六）其他有关材料。\n（一）《补发婚姻登记证审查处理表》；（二）《申请补领婚姻登记证声明书》；（三）婚姻登记档案保管部门出具的婚姻登记档案记录证明或其他有关婚姻状况的证明；（四）当事人身份证件复印件；3  X民政部发布     民政部规章（五）当事人委托办理时提交的经公证机关公证的当事人身份证件复印件和委托书，受委托人本人的身份证件复印件；（六）其他有关材料。\n第九条  婚姻登记档案按照年度—婚姻登记性质分类。婚姻登记性质分为结婚登记类、撤销婚姻类、离婚登记类和补发婚姻登记证类四类。人民法院宣告婚姻无效或者撤销婚姻的判决书副本归入撤销婚姻类档案。婚姻无效或者撤销婚姻的，应当在当事人原婚姻登记档案的《结婚登记审查处理表》的“备注”栏中注明有关情况及相应的撤销婚姻类档案的档号。\n第十条  婚姻登记材料的立卷归档应当遵循下列原则与方法：（一）婚姻登记材料按照年度归档。（二）一对当事人婚姻登记材料组成一卷。（三）卷内材料分别按照本办法第五、六、七、八条规定的顺序排列。（四）以有利于档案保管和利用的方法固定案卷。\n（五）按本办法第九条的规定对案卷进行分类，并按照办理婚姻登记的时间顺序排列。4  X民政部发布     民政部规章（六）在卷内文件首页上端的空白处加盖归档章（见附件1），并填写有关内容。归档章设置全宗号、年度、室编卷号、馆编卷号和页数等项目。全宗号：档案馆给立档单位编制的代号。年度：案卷的所属年度。开始标注。馆编卷号：档案移交时按进馆要求编制。页数：卷内材料有文字的页面数。\n（七）按室编卷号的顺序将婚姻登记档案装入档案盒，并填写档案盒封面、盒脊和备考表的项目。档案盒封面应标明全宗名称和婚姻登记处名称（见附件2）。档案盒盒脊设置全宗号、年度、婚姻登记性质、起止卷号和盒号等项目（见附件 3）。其中，起止卷号填写盒内第一份案卷和最后一份案卷的卷号，中间用“—”号连接；盒号即档案盒的排列顺序号，在档案移交时按进馆要求编制。备考表置于盒内，说明本盒档案的情况，并填写整理人、检查人和日期（见附件 4）。\n5  X民政部发布     民政部规章（八）按类别分别编制婚姻登记档案目录（见附件 5）。（九）每年的婚姻登记档案目录加封面后装订成册，一式三份，并编制目录号（见附件 6）。第十一条  婚姻登记材料的归档要求：（一）当年的婚姻登记材料应当在次年的 3 月 31 日前 完成立卷归档；（二）归档的婚姻登记材料必须齐全完整，案卷规范、整齐，复印件一律使用 A4 规格的复印纸，复印件和照片应当图像清晰；（三）归档章、档案盒封面、盒脊、备考表等项目，使用蓝黑墨水或碳素墨水钢笔填写；婚姻登记档案目录应当打印；\n\n[9]文档来源:民政部关于贯彻落实中华人民共和国民法典中有关婚姻登记规定的通知_规范性文件_20201204110000_社会事务司.pdf\n切片内容:当事人亲自签订的离婚协议书原件存档。婚姻登的长方形红色印章并填写日期。    三、离婚登记档案归档    婚姻登记机关应当按照《婚姻登记档案管理办法》规定建立离婚登记档案，形成电子档案。    归档材料应当增加离婚登记申请环节所有材料（包括撤回离婚登记申请和视为撤回离婚登记申请的所有材料）。\n\n[10]文档来源:263575.pdf\n切片内容:民政部规章婚姻登记档案管理办法(2006 年 1 月 23 日民政部、国家档案局令第 32 号公布  自公布之日起施行)第一条  为规范婚姻登记档案管理，维护婚姻当事人的合法权益，根据《中华人民共和国档案法》和《婚姻登记条例》，制定本办法。第二条  婚姻登记档案是婚姻登记机关在办理结婚登记、撤销婚姻、离婚登记、补发婚姻登记证的过程中形成的具有凭证作用的各种记录。\n\n"
# 【模型回复】"根据《婚姻登记档案管理办法》（民政部、国家档案局令第32号）第十五条的规定，婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证。律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案。因此，律师调取本人婚姻登记情况只需出具委托书及律师有效证件、律所介绍信的说法并不完全准确，根据上述规定，若律师需要查阅与诉讼相关的婚姻登记档案，还需持有受理案件的法院出具的证明材料。对于婚姻当事人因故不能亲自前往查阅的，委托书应当经过公证机关公证。建议您根据具体情况准备相关材料，并咨询当地婚姻登记机关获取更详细的指引。"
#
# 【带引用的回复】根据《婚姻登记档案管理办法》（民政部、国家档案局令第32号）第十五条的规定，婚姻当事人持有合法身份证件，可以查阅本人的婚姻登记档案；婚姻当事人因故不能亲自前往查阅的，可以办理授权委托书，委托他人代为办理，委托书应当经公证机关公证[3]。律师及其他诉讼代理人在诉讼过程中，持受理案件的法院出具的证明材料及本人有效证件可以查阅与诉讼有关的婚姻登记档案[1]。因此，律师调取本人婚姻登记情况只需出具委托书及律师有效证件、律所介绍信的说法并不完全准确，根据上述规定，若律师需要查阅与诉讼相关的婚姻登记档案，还需持有受理案件的法院出具的证明材料。对于婚姻当事人因故不能亲自前往查阅的，委托书应当经过公证机关公证[3]。建议您根据具体情况准备相关材料，并咨询当地婚姻登记机关获取更详细的指引。
#
# 请完成下列任务：
# """
# qwen = QwenClient(system_prompt=SYSTEM_PROMPT3)
#
# input_file_path1 = "大模型回答(top10).jsonl"
# input_file_path2 = '回答分数(top10).jsonl'
# # output_file_path = '带引用的回答(top10).jsonl'
# input_file_path3 = '带引用的回答(top10).jsonl'
# output_file_path = 'chunk粒度_引用标注.jsonl'
# questions = ['《关于加强社会组织反腐倡廉工作的意见》（民发〔2014〕227号）文件中，第三条“社会组织应当在资产、机构、人员等方面与所举办经济实体分开”。关于这条规定，有无具体的解释性说明，或者实践中的指引或规范。\r我协会A下有一家举办的经济实体B公司，B公司是有限责任公司性质，A协会是100股权。结合我协会的实际，我的理解和问题如下：\r1、资产分开：我的理解，A协会举办的全资B公司，按照公司法，B公司所有资产都应该是股东方A协会的。在A协会的财务报表中，对B公司的投资款也列在长期股权投资中，作为A协会的资产。B公司也会根据年度收益情况对A协会进行分红，B公司经营情况会纳入A协会每年的财务工作报告，向会员代表大会报告。我想咨询在《意见》中的资产分开，具体指什么分开，应该如何操作是符合规定的。\r2、机构分开：这里机构具体指的是什么形式。目前A协会和B公司都是登记的法律主体。\r未完，请看第2条', '慈善组织可以设立专项基金吗？有何条件？如何设立？', '强烈要求应该是要当期同一种彩票玩法单注中奖奖金达到500元的时候，当期同一种彩票玩法个人中奖奖金金额总共累计达到五万元才缴纳个人所得税20这样子才比较合理。 \r\r当期同一种彩票玩法个人中奖奖金达到5000元才进行实名登记。兑奖截止时间从开奖第二天开始起总共100天，超过兑奖规定截止100天时间的所有中奖彩票玩法奖金一律不能够再进行兑奖', '现在殡仪馆以外的非法运尸车辆打着殡仪馆的旗号，从事非法经营活动，导致丧户祭祀成本增加且没有安全保障，非法运尸的行为是否为非法营运？对于这些车辆，由哪个部门处理？如果是交通运输部门，参照的法律依据是什么？会怎么处理这些非法运尸车辆。', '按照财政部、税务总局、民政部公告2020年第27号文，以上三部门2024年1月15日公告的公益性捐赠税前扣除资格的公益性社会组织名单，一共才23家。想咨询地方慈善基金会如何申请纳入公益性捐赠税前扣除资格的公益性社会组织名单，有没有通道？如果没有通道，地方慈善基金组织如何开展慈善活动，因为无法鼓励更多人来捐款。', '低保中的60岁老人每月领取200元的困难老人生活补贴是否可与80元困难残疾人生活补贴同时领取', '计划生育别特扶助金是否计入家庭收入，按照以前的留言回复是应该计入家庭收入，但是多数省份的低保认定时计划生育别特扶助金是不计入家庭收入的，请问为什么都是困难人群，规定却不一样？很多市级政府出台政策，规定计划生育别特扶助金不计入家庭收入，是否违反民政部规定，市级政府出的文件是否有效？', '优抚对象入住光荣院后，能否同时申请享受低保待遇？', '民发〔2022〕83号文件中规定“成年无业重度残疾人可以参照“单人户”提出低保申请”，中的成年的年龄范围是多少？', '民政部等8部委1993年发布的民事发【1993】2号明确规定：”尸体的运送，除特殊情况外，必须由殡仪馆承办，任何单位和个人不得擅自承办；凡属异地死亡者，其尸体原则上……，由殡仪馆专用车辆运送“。但对具体的处罚没有明确的规定。现在有个别殡仪服务公司在没有运尸证明的情况下违规接运尸体。请问此问题该由哪个部门来处理？如何处理？民政部门在这个问题上应该有什么样的监管责任？请详细告知，以便于民政部门在日常工作中作为工作依据。', '在办理社会组织成立登记或变更登记时，如果确定业务主管单位不明确或存在争议，依据怎样的原则和法规、文件、政策依据确定其业务主管单位？', '关于会费的几个问题？（已检索，未见类似留言）\r如某协会有单位会员和个人会员（理事也有理事单位、个人理事），会费设置4档（会长、副会长、理事、会员），且每档标准明确，请问会费收取，能否明确单位缴纳、个人不缴纳？\r如某协会会费标准仅设会长一档（会费标准30万元/年），是否符合规范要求？\r如某协会认为申领、使用、管理会费票据手续繁琐，且大部分会员明确不要票据，若干需要的，直接开具税务票据，请问此类情况是否可行？', '负责人，您好！我是执业律师，因办理案件，需要向人民法院申请调查令，查询对方当事人的婚姻登记信息。我的问题：1 目前，婚姻登记，包括以前的信息，是否已经全部电子化？2 婚姻登记是否已经实现全国联网，凭法院调查令是否可以到任意婚姻登记部门查询对方的婚姻登记状况，还是必须到对方户籍地或暂住地的部门查询？这也是很多律师遇到的困扰，盼您解答。谢谢。', '你好，我想咨询一下，国家对遗体接运车有没有专项规定？民间个体是否可以从事这项业务？应该从哪些单位或厂家购置遗体接运车？改装有何要求？谢谢', '收养三代以内同辈旁系血亲的子女需要提供的亲属关系证明可以由县级公安机关出具吗，收养人和送养人的亲子鉴定结果能否等同亲属关系证明？比如，A与B是同父母的亲姐妹关系，A为送养人，B为收养人，B收养A的子女，但是由于一些特殊原因，B从小被别的家庭养大，随养父姓，且B的户口在养父母家，与A不在同一户口下。这种情况，B收养A的子女所需要的亲属关系证明要怎么开才能办理收养？', '经网上查获：为进一步加强对公益性捐赠税前扣除资格的管理工作，财政部牵头，会同税务总局和民政部出台了《关于公益性捐赠税前扣除有关事项的公告》财政部公告2020年第27号，将社会组织评估等级为3A以上含3A作为获得公益性捐赠税前扣除资格的必要条件之一。\r咨询事项：\r1.公益性捐赠税前扣除资格认定和非营利组织免税资格认定，社会组织机构因其他原因无法评估在没有参与评估的情况下是否还能申请此资格认定？？？\r2.之前在国家税务总局四川省税务局网上申请过，审核未通过，结论是民政厅发的执照不归税务局管辖。\r3.此资格认定是向民政厅还是税务机关？', '贵州省毕节市七星关区放珠镇永安村低保人员查询', '请问一下，社会组织需要办理变更开办资金申请，在办理减资时，需要提交验资报告，验资报告中的现有的资金数额是满足大于等于减资后的开办资金就可以，还是需要大于等于减资前的开办资金才能申报减资登记?假如我的开办资金是100万元，需要变更开办资金到50万元，我需要提交50万元的验资报告还是提交100万元的验资报告才可以办理减资？', '残疾人本人首次办理的残疾证新证签发时间为2024年2月1日，于2024年2月19日提出残疾人两项补贴困难生活补贴和重度护理补贴）申请并提交申请要求提供的资料，资料通过相关部门审核通过。本人享受补贴是从2024年2月起享受还是从2024年3月份起享受？', '理事会换届，哪些人需要进行离任审计？', '根据《关于进一步做好最低生活保障等社会救助兜底保障工作的通知》（民发〔2022〕83号），烦请解读关于成年无业重度残疾人均可以参照“单人户”提出低保申请问题，具体如下：\r1、成年无业重度残疾人中的“成年”具体是指多少岁？\r2、一名52周岁成年无业患有一级智力残疾女性，无退休金，但是达到女职工年满50周岁，请问能否单独申请低保？', '我本人担任2间机构的法人，分别是：\r1.兴宁市阳光义工协会（2013年2月注册，注册类型‘社会团体’）；\r2.兴宁市阳光社会工作服务中心（2017年2月注册，注册类型‘民办非企业单位’）。\r最新的《社会组织名称管理办法》颁布后，管理部门征询我的意见，认为根据《管理办法》第十六条，“阳光”字号重复，其中1个机构要改名。\r我咨询的问题是：2间机构，不是“同行业领域”，也不是“同组织形式”，我本人认为没有违反《管理办法》的规定，不用改名，但我需要权威的解释。\r恳请答复为盼！\r谢谢！', '尊敬的领导，你好，我想要咨询两个问题，烦请具体回应一下。\r1、问题1：成年无业重度残疾人单独申请低保的年龄界定问题，成年无业重度残疾人中的“成年”具体是指多少岁？\r2、问题2：一个满年52周岁患有智力一级残疾女士，没有工作，没有享受养老金待遇，但是达到退休年龄，请问能否单独申请低保？\r\r注：1、根据《关于进一步做好最低生活保障等社会救助兜底保障工作的通知》（民发〔2022〕83号）有关要求，成年无业重度残疾人均可以参照“单人户”提出低保申请。\r2、退休年龄：女职工退休年龄是年满50周岁。', '请问全国性协会是否允许聘请退休人员作为专职工作人员？', '老师好！咨询、请教两个问题：\r1、申请民办非企业单位（设立）登记时，举办者应当根据《民办非企业单位登记管理暂行条例》第九条、中国社会组织政务服务平台“办事指南”栏目下的“民办非企业单位成立登记办事指南”第八条“申请材料目录”规定应向民政部门提交文件，这些文件是否属于负责登记的属地民政部门保存的政府信息？\r2、一般公民如想了解、查询某民非单位设立登记时提交的上述第九条内的文件，是否可以向负责登记的属地民政部门申请政府信息公开？\r请您对应解答，谢谢！', '尊敬的民政部领导您好：现有一所民办高级中学（2003年登记为民办非企业单位）因办学问题需申请变更法人才能设立对公账务处理后续办学事宜，但民政局组织会计师事务所对原法人进行离任审计，因时间久远期间财务资料不齐，无法提供完整账务，会计师事务所无法出具离任审计报告，导致民政部门以此为由无法办理法人变更且无解决途径。《民办非企业单位登记管理暂行条例》第22条仅规定“民办非企业单位变更法定代表人...登记管理机关应当组织对其进行财务审计”并未明确将财务审计作为申请变更法人前置条件，且要求出具离任审计报告；《民办非企业单位登记暂行办法》作为部门规章，可否设置行政许可暂且不谈，第11、12条也并未明文规定离任审计报告作为申请变更法人的必备材料之一；政务服务网上的相关法人变更登记事项也未要求申请人提供离任审计报告；请问领导：法人变更与离任审计究竟有何必要关系，可否并行处理，开发区八千学子望回复为盼，感谢。', '您好，咨询关于补办结婚登记、补领结婚证的相关手续问题。\r\r一、具体情况\rA与B于1989年在民政所登记结婚并领取结婚证，2022年底经查询发现在婚姻登记系统查无二人婚姻登记信息，民政所也反馈遗失了原始婚姻登记档案。现两人考虑补办婚姻登记。\r\r二、咨询问题\r1、在两本结婚证原件均存在，仅系统查无婚姻登记的情况下，是否可以只按补办婚姻登记的流程进行补办？相关规定是？\r2、若按补领结婚证的流程，能否在新的结婚证或者其他文件备注补办的真实原因？如“因档案丢失，查无婚姻登记信息”而补办，相关规定是？\r\r静候佳音。', '两个问题1、八几年登记无结婚档案，现女方因疾病后遗症神志不清不能写字也无法交流，是否可以通过村居证明，子女书写见证及户口在同一本上的记载，为其补领结婚证？2、有结婚档案，但女方严重智力残疾不能写字也不能沟通，是否可以凭结婚档案补领男方单方的结婚证？', '父母于1986年4月30日登记结婚，结婚证上只有双方的姓名、年龄，无身份证号码信息，盖的章为XX县XX区公所，后因该结婚证遗失一份，故父母于2012年6月13日去当地民政局补办结婚证，结果登记日期为2012年6月13日，非最初的结婚登记日1986年4月30日，结婚证备注中也没有结婚证毁损，补发此证及补发日期等信息。我是1987年7月出生，现在导致我从婚生子变成非婚生子，父母户口迁移等很多事情办理存在阻碍。已咨询当地民政工作人员，工作人员说该结婚证登记日期已上传至民政部，无法修改和作废，原结婚证相关档案因机构变更，资料遗失，因此无法辨别老结婚证真伪，无法重新补办结婚证，将结婚登记日期写为1986年4月30日。请问我该怎么办？', '根据规定，业务主管单位负责对民办非企业单位年度检查的初审，举例：如对养老机构类民办非企业的年检初审，作为民政部门养老服务股，需初审的项目和内容有哪些？', '1、收养人情况：①男方为台湾同胞，1966年生，在台湾已离婚，有一婚生子女随母生活，离婚时将台湾的所有财产给了前妻和孩子，名下已无台湾财产。后来到中国内地创业、结婚，目前已在中国内地结婚，截止目前已在内地居住16年，后续也将长期居住在中国内地。\r②女方1977年出生，婚后双方多年未育。双方拟在内地收养一子女。\r2、被收养人情况：被收养人为一7岁女孩，系女方的外甥女，被收养人与女方属三代以内旁系血亲。\r\r问题：①收养人在台湾无资产，在中国内地有股权、房产等财产，是否可以不提供其在台湾的财产证明，仅提供中国内地的财产、工作、收入等证明？\r② 前述在中国内地出具的财产、工作、收入证明是否仍应当经过台湾与国内两处公证？\r③ 收养人在中国内地的指定医院体检，是否无需经过公证？', '你好，2018年-2019年期间在监狱服刑，在此期间政府并没有停发残疾人补贴，也没有看到有文件规定要求停发服刑残疾人的补贴。2021年出台了新的文件规定监狱服刑残疾人自判决生效之日起停发补贴，想请问2018年-2019年间发放的残疾人补贴是否会被政府追回。如果2018年-2019年有文件规定服刑的残疾人停发补贴，请明确告知', '想咨询一下:城市道路指示牌中的路名书写，比如人民路是应该写成:Renmin Lu还是写成:RENMIN Rd.或写成:RENMIN LU。', '你好，户主是依靠父母兄弟姐妹供养的成年重度无业残疾人，其父母亲均超60岁以上，无劳动能力，弟弟未婚，在外打工，但是在户籍地市区购买有商品房，按照这种情况是核对四人的家庭财产状况后再单独将户主纳入低保？还是说只需要系统核查户主一人的家庭财产收入状况？', '某体育类社会团体，开展业务培训，能否向培训对象收取培训费？', '请问一下，没有使用殡仪馆的殡葬车，而是运用私家车异地运输遗体，应该由哪个部门来处理？如何处理？有没有相关的法律法规？', '本人母亲于2017年在村口捡拾一弃婴，后一直由本人收养且共同生活至今，孩子已满6岁，到了上小学的年纪，但领养证一直办不下来，影响孩子上学。咨询过当地民政部门，给的答复是由于当时没有向公安机关报案，且需送到当地福利院，从福利院领养才可以办领养证；但是现在这种情况怎么办？现在也不可能在把再孩子送到福利院去，那样对孩子身心会造成很大的伤害，想咨询一下国家民政部门，这种情况怎么才能办领养证，解决孩子上学问题。', '您好！我们是地方社会组织审批机关工作人员，现有一疑问咨询：《社会团体登记管理条例》第二十七条中规定“社会团体在换届或者更换法定代表人之前，登记管理机关、业务主管单位应当组织对其进行财务审计。”《民办非企业单位登记管理暂行条例》第二十二条中规定“民办非企业单位变更法定代表人或者负责人，登记管理机关、业务主管单位应当组织对其进行财务审计。”那么作为登记机关，在对社会组织进行以上财务审计时，是否应当要求社会组织必须在登记机关指定的某（某些）家有资质的会计师事务所进行审计？如果要求社会组织必须在登记机关指定的某（某些）家有资质的会计师事务所进行审计，是否合规？', '1, 依据《中华人民共和国村民委员会组织法》第一章总则第二条：村民委员会是村民自我管理、自我教育、自我服务的基层群众性自治组织，实行民主选举、民主决策、民主管理、民主监督。\r（1）在依法依规的前提下，村民代表会议制定适合本村的选民登记细则，指导本村选民登记，是否有权制定？\r（2）在此基础制定：“为了孩子上学，户口迁走的本村村民，同意给予选民登记。”经村民代表会决议通过并公示。\r（3）依上面的规定，村选委会将数十名符合的村民登记为选民且公示，公示期内无任何异议。\r（4）此类人尽管户口不在本村，但其本人和家人都长期在村内居住，有自己的房产，享受村民所有福利和义务。\r（5）公示期结束后，有村民对此类人中的一个天津户口村民有异议，理由是本区或本市内的户口可以给，天津的跨省了人在村住也不能给选民登记。\r（6）他这么说合法么？一是过了公示期，二是有什么法律依据？户口在一个区或跨省，都属于户口不在本村。', '近年来，国家各级政府都在倡导绿色安葬，由撒散、树葬、花葬、草坪葬为主要形式的生态安葬逐渐兴起，但是每个地区对于生态葬人员身份的限制事实存在，我查阅了国务院到地方政府各层级关于生态葬相关文件及政策规定，均没有对生态安葬区可以入葬的人员户籍范围进行限定，但是生态葬奖补的人群范围会有限定，想咨询三点：1,.生态葬安葬区入葬人员身份是否限定户籍？2.是否可以用当地生态葬奖补政策为依据限定生态葬入葬人员户籍范围？3.如生态葬不限定户籍或入葬人员身份，请给予明确答复，谢谢。', '一县份群众在2016年捡拾到弃婴，今年才带着孩子到公安局报案。想办理收养，但是到民政部门得知，未经过儿童福利机构属于私自收养，孩子现在七岁了，要读书，县份没有儿童福利机构，孩子报案之后是一定要去救助站或者儿童福利机构么，可以继续跟着群众生活吗？孩子读书了也要离开所在县份去到市区吗？可以告诉我们应该怎么处理这个问题吗？谢谢！', '民发〔2022〕83 号文件中是依靠兄弟姐妹或者60 周岁及以上老年人供养的成年无业重度残疾人可以参照“单人户”申请低保，还是指所有成年无业重度残疾人参照‘单人户”申请低保，或者有子女赡养的成年无业重残人员也可参照“单人户”申请低保吗？', '《民政部、财政部、国务院扶贫办关于在脱贫攻坚三年行动中切实做好社会救助兜底保障工作的实施意见》等政策文件中的“单人户”是指该家庭只有一人，无共同生活的其他家庭成员。参照单人户纳入低保是指“生活困难、靠家庭供养且无法单独立户的成年无业重度残疾人可以参照单人户纳入最低生活保障范围”，该句话中是指”无法单独立户“的成年无业重度残疾人！而我女儿属于成年无业重度残疾人”已经单独立户了“，已是”单人户“！为什么还要参照“单人户”提出低保申请？请问“单人户”算不算一个单独家庭？', '1.按照《殡葬管理条例》第22条，如子女为去世父母制造封建迷信殡葬用品，是否适用此罚则。\r2.《殡葬管理条例》第20条，民政部门作出责令限期改正后，当事人拒不改正的，民政部门可否申请人民法院强制执行？', '2010年6月出生的儿童，其爸爸已于2010年2月15日死亡，其妈妈于2010年7月离家出走，现该儿童由60岁左右的爷爷奶奶监护。经属地部门查询，其儿童母亲改嫁外省，且至今未与该儿童及其儿童家属联系，未履行抚养责任，截止目前失去联系时间长达12年之久。请问该儿童是可以享受事实无人抚养政策？该儿童家属经向属地部门咨询，部门反馈说：该儿童母亲在网上能查询得到信息，不存在失联，所以不能享受该政策，请问该儿童母亲的失联是否可以按照《民政部 公安部 财政部关于进一步加强事实无人抚养儿童保障工作提出如下意见》（民发〔2020〕125号）文件规定的精准失联方式中的第二种方式进行认定，即：采取“个人承诺邻里证明村居证实乡镇人民政府街道办事处查验县级民政部门确认”的方式，形成《儿童父母失联情况认定表》进行认定。', '您好！慈善组织年度人员工资福利不能超过当年管理费用的百分之60，有没有相关的文件依据，如果超过了，对慈善组织的评估、税前扣除，免税资格认定有什么影响？', '背景：在民办非企业单位（以博物馆为例）设立过程中，举办人申请/登记材料中对开办资金的约定为500万元，但后续章程中约定的开办资金为100万元，请问举办者所负的开办资金责任以何者为限？申请/登记材料和内部章程何者是规范举办人出资义务的有效依据？', '安阳鹤壁行政区划犬牙交错、相互侵占，导致经济社会发展受到严重影响。\r1.安阳市汤阴县深入鹤壁市区，鹤壁市区北部紧贴汤阴县界，严重制约鹤壁市主城区向北发展。\r2.鹤壁市山城区、鹤山区（合称鹤壁老区）深入安阳腹地，由于历史和区划原因当地人纷纷在25公里以外鹤壁新区买房落户，导致新区对老区形成虹吸效应，城市人口锐减，城市建设几乎停滞，当地人归属感极差。\r3.不合理区划造成文化割裂。如东酒寺村属于安阳汤阴，西酒寺村属于鹤壁山城；大盖族村属于安阳汤阴；小盖族村属于鹤壁淇滨。\r综上所述，建议：\r1.鹤壁市山城区、鹤山区合并为新县级区（建议命名为鹤壁区），划归安阳市管辖。\r2.滑县距离安阳市区较远，且中间被鹤壁市阻隔，建议划归鹤壁市管辖。\r3.撤销鹤壁市，现鹤壁市淇滨区、淇县、浚县，安阳市滑县依托现鹤壁市区、淇县城区成立新地级市（与滑县、浚县城区形成掎角之势），建议命名为朝歌市。', '低保村上要不要公示？']
# questions_set = set(questions)
#
# # 加载已有的回复
# existing_data = {}
# with open(input_file_path3, 'r', encoding='utf-8') as f3:
#     for line in f3:
#         record = json.loads(line.strip())
#         existing_data[record["问题内容"].strip()] = record
#
# with open(input_file_path1, 'r', encoding='utf-8') as f1, open(input_file_path2, 'r', encoding='utf-8') as f2, open(output_file_path, 'w', encoding='utf-8') as f4:
#     for i,(line1, line2) in enumerate(tqdm(zip(f1, f2), desc="Citing")):
#         record1 = json.loads(line1.strip())
#         record2 = json.loads(line2.strip())
#
#         question = record1.get('问题内容').strip()
#         score = record2.get('分数')
#         if score < 8:
#             continue
#
#         if question in questions_set:
#             docs = record1.get('所需文档').strip()
#             answer = record1.get('模型回复').strip()
#
#             # prompt = f"<|im_start|>system\n{SYSTEM_PROMPT3}<|im_end|>\n" \
#             #          f"<|im_start|>user\n【问题内容】{question}\n【所需文档】{docs}\n【模型回复】{answer}\n" \
#             #          f"<|im_start|>assistant\n【带引用的回复】"
#             prompt = f"问题内容】{question}\n【所需文档】{docs}\n【模型回复】{answer}"
#
#             # inputs = tokenizer(prompt, return_tensors="pt").to(model.device)
#             cited_answer = qwen.chat(prompt)
#             # with torch.no_grad():
#             #     outputs = model.generate(
#             #         **inputs,
#             #         max_new_tokens=768,
#             #         pad_token_id=tokenizer.eos_token_id,
#             #         eos_token_id=tokenizer.eos_token_id,
#             #         do_sample=False
#             #     )
#             # output = tokenizer.decode(outputs[0], skip_special_tokens=True)
#             # cited_answer = output.split("【带引用的回复】")[-1].strip().split()[0]
#             output_record = {
#                 "问题内容": question,
#                 "分数": score,
#                 "所需文档": docs,
#                 "带引用的文档": cited_answer,
#             }
#             time.sleep(1.5)
#         else:
#             # 使用原有引用回答
#             output_record = existing_data.get(question)
#             if output_record is None:
#                 # 没找到就跳过，避免报错
#                 continue
#         f4.write(json.dumps(output_record, ensure_ascii=False) + "\n")

SYSTEM_PROMPT4 = """
你是一个精通政策引用标注的人工智能助手。请你根据【问题内容】以及提供的多个政策文档切片，对给定的回答内容【模型答案】加上引用标注。

【任务目标】：
1. 请保持原回答的表达内容**完全不变**。
2. 你只需要在其中合适的地方加上引用编号，如[1-2],[2-3],这些编号对应下方给出的文档切片中的句子；
3. 若某句或某段话的内容表达的意思与文档中某个句子的内容高度相符，请在该句末尾处加上对应编号；注意：需要是高度相符！
4. 每次引用**只使用一个编号**，**不重复标注**；
5. 请输出完整的加标注后的【回答】，不需要其他解释说明。
"""
qwen = QwenClient(SYSTEM_PROMPT4)

input_file_path = 'dataset(sub_sentence)_ans.jsonl'
output_file_path = 'sub_sentence粒度_引用标注.jsonl'

with open(input_file_path, 'r', encoding='utf-8') as f1, open(output_file_path, 'w', encoding='utf-8') as f2:
    for line in tqdm(f1, desc="citing"):
        record = json.loads(line.strip())

        question = record.get('问题内容')
        docs = record.get('所需文档')
        score = record.get('分数')
        answer = record.get('模型回复')

        prompt = f"问题{question}\n文档{docs}\n模型答案{answer}"

        result = qwen.chat(prompt)
        output_record = {
            "问题内容": question,
            "分数": score,
            "所需文档": docs,
            "带引用的答案": result,
        }

        f2.write(json.dumps(output_record, ensure_ascii=False) + '\n')

# SYSTEM_PROMPT5 = """
# 你是一个善于划分子句的人工智能助手。你将收到几个政策类文本的 chunk，这些 chunk 已经标注上了编号，请你按照子句（sub-sentence）级别进行语义划分。
#
# 划分要求如下：
# 1. 每个 chunk 以原格式开头，保留如下结构：
#     [X]文档来源:xxx.pdf
#     切片内容:
# 2. 子句划分后，每一行用如下格式标注：
#     [X-Y]: 子句内容
#     - 其中 X 是 chunk 编号，Y 是该 chunk 中的子句序号，从 1 开始；
# 3. 子句应当是语义完整的语句，避免机械按标点切分；
# 4. 不允许合并不同 chunk 的内容；
# 5. 除了原始 chunk 的文档编号、文档来源、切片内容和子句编号，不要输出任何额外内容；
# 6. 不要省略、不重写 chunk 原文，只做划分与标注；
# 7. 原文格式中若存在换行或特殊结构，请一并保留。
#
# 请严格按照以下示例格式输出：
#
# 【示例输入】：
# [1]文档来源:example.pdf
# 切片内容:这是第一句话；这是第二句话，也可以看作第二个子句。
#
# 【示例输出】：
# [1]文档来源:example.pdf
# 切片内容:
# [1-1]: 这是第一句话；
# [1-2]: 这是第二句话，也可以看作第二个子句。
# """
#
# qwen = QwenClient(SYSTEM_PROMPT5)
#
# input_file_path = 'chunk粒度_引用标注.jsonl'
# output_file_path = 'dataset(sub_sentence).jsonl'
#
# # 加载已经标注好的回复
# question_list = set()
# with open(output_file_path, 'r', encoding='utf-8') as f:
#     for line in f:
#         record = json.loads(line.strip())
#         question = record.get('问题内容')
#         question_list.add(question)
#
# with open(input_file_path, 'r', encoding='utf-8') as f1, open(output_file_path, 'a', encoding='utf-8') as f2:
#     for line in tqdm(f1, desc="分割中……"):
#         record = json.loads(line.strip())
#
#         question = record.get('问题内容')
#         score = record.get('分数')
#         docs = record.get('所需文档')
#
#         if question in question_list:
#             continue
#
#         prompt = f"文档{docs}"
#         result = qwen.chat(prompt)
#
#         output_result = {
#             "问题内容": question,
#             "分数": score,
#             "所需文档": result,
#         }
#
#         f2.write(json.dumps(output_result, ensure_ascii=False) + '\n')